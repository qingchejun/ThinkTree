# CLAUDE.md - ThinkTree é¡¹ç›®é…ç½®

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**ThinkTree** æ˜¯ä¸€ä¸ª AI é©±åŠ¨çš„æ€ç»´å¯¼å›¾ç”Ÿæˆå·¥å…·ï¼Œå¯¹æ ‡ Mapify.soï¼Œä½¿ç”¨å…ˆè¿›çš„æŠ€æœ¯æ ˆå®ç°æ–‡æ¡£åˆ°æ€ç»´å¯¼å›¾çš„æ™ºèƒ½è½¬æ¢ã€‚

**å½“å‰ç‰ˆæœ¬**: v1.2.0 - äº‘ç«¯éƒ¨ç½²å®Œæˆ

### æ ¸å¿ƒæŠ€æœ¯æ¶æ„

```
ç”¨æˆ·è¾“å…¥ â†’ FastAPIåç«¯ â†’ Google Gemini AI â†’ Markdownæ•°æ® â†’ markmap-libè½¬æ¢ â†’ markmap-viewæ¸²æŸ“
éƒ¨ç½²: Render Cloud Platform (Singapore)
```

### ğŸŒ çº¿ä¸Šåœ°å€

- **å‰ç«¯**: https://thinktree-frontend.onrender.com
- **åç«¯**: https://thinktree-backend.onrender.com
- **API æ–‡æ¡£**: https://thinktree-backend.onrender.com/docs
- **å¥åº·æ£€æŸ¥**: https://thinktree-backend.onrender.com/health

## ğŸ› ï¸ æŠ€æœ¯æ ˆè¯¦æƒ…

### å‰ç«¯ (Next.js 14)

- **æ¡†æ¶**: Next.js 14 App Router
- **UI åº“**: React 18 + Tailwind CSS 3
- **æ€ç»´å¯¼å›¾**: markmap-view + markmap-lib + D3.js
- **ç‰¹æ€§**: å“åº”å¼è®¾è®¡ï¼Œè‡ªé€‚åº”å¸ƒå±€ï¼Œå®æ—¶æ¸²æŸ“
- **éƒ¨ç½²**: Render (Singapore)

### åç«¯ (FastAPI)

- **æ¡†æ¶**: FastAPI + Python 3.11
- **AI å¼•æ“**: Google Gemini API
- **æ–‡ä»¶å¤„ç†**: PyMuPDF + pdfplumber + python-docx
- **API è®¾è®¡**: RESTful API + è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ
- **éƒ¨ç½²**: Render (Singapore) + gunicorn

### æ–‡æ¡£è§£æèƒ½åŠ›

- **PDF**: PyMuPDF (é«˜æ€§èƒ½) + pdfplumber (å¤‡ç”¨)
- **Word**: python-docx (DOCX æ ¼å¼)
- **æ–‡æœ¬**: TXT, MD, SRT å­—å¹•æ–‡ä»¶
- **ä¸Šä¼ **: æ–‡ä»¶å¤§å°é™åˆ¶ 10MBï¼Œæ‹–æ‹½ä¸Šä¼ æ”¯æŒ

## ğŸ“ é¡¹ç›®ç»“æ„

```
ThinkTree/
â”œâ”€â”€ frontend/                    # Next.jså‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/                    # App Routeré¡µé¢ç›®å½•
â”‚   â”‚   â”œâ”€â”€ page.jsx           # ä¸»é¡µ (/)
â”‚   â”‚   â”œâ”€â”€ test/page.jsx      # æ€ç»´å¯¼å›¾æµ‹è¯•é¡µ (/test)
â”‚   â”‚   â”œâ”€â”€ editor/page.jsx    # ç¼–è¾‘å™¨é¡µé¢ (/editor)
â”‚   â”‚   â”œâ”€â”€ login/page.jsx     # ç™»å½•é¡µé¢ (/login)
â”‚   â”‚   â”œâ”€â”€ dashboard/page.jsx # æ§åˆ¶å°é¡µé¢ (/dashboard)
â”‚   â”‚   â”œâ”€â”€ share/[token]/page.jsx # åˆ†äº«é¡µé¢
â”‚   â”‚   â”œâ”€â”€ layout.jsx         # æ ¹å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ not-found.jsx      # 404é¡µé¢
â”‚   â”‚   â””â”€â”€ error.jsx          # é”™è¯¯é¡µé¢
â”‚   â”œâ”€â”€ components/             # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ mindmap/           # æ€ç»´å¯¼å›¾ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SimpleMarkmap.jsx    # ä¸»è¦çš„Markmapç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MarkmapView.jsx      # åŸå§‹Markmapç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SimpleMindMap.jsx    # å¤‡ç”¨ç®€å•ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ThinkTreeEditor.jsx  # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ upload/            # æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ FileUpload.jsx      # æ–‡ä»¶ä¸Šä¼ å’Œæ–‡æœ¬è¾“å…¥
â”‚   â”‚   â”œâ”€â”€ common/            # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ErrorBoundary.jsx   # é”™è¯¯è¾¹ç•Œ
â”‚   â”‚   â”‚   â””â”€â”€ Toast.jsx           # æ¶ˆæ¯æç¤º
â”‚   â”‚   â””â”€â”€ share/             # åˆ†äº«ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ lib/                   # å·¥å…·åº“
â”‚   â”‚   â””â”€â”€ api.js            # APIè°ƒç”¨å°è£…
â”‚   â”œâ”€â”€ styles/               # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ globals.css       # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ markmap.css       # Markmapä¸“ç”¨æ ·å¼
â”‚   â”œâ”€â”€ package.json          # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â””â”€â”€ next.config.js        # Next.jsé…ç½®
â”œâ”€â”€ backend/                     # FastAPIåç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/                    # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/               # APIè·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ upload.py     # æ–‡ä»¶ä¸Šä¼ å’Œæ–‡æœ¬å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ mindmaps.py   # æ€ç»´å¯¼å›¾CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py       # ç”¨æˆ·è®¤è¯
â”‚   â”‚   â”‚   â””â”€â”€ share.py      # åˆ†äº«åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ ai_processor.py    # Google Gemini AIå¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ file_parser.py     # æ–‡ä»¶è§£æå™¨
â”‚   â”‚   â”‚   â””â”€â”€ config.py          # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ main.py               # FastAPIä¸»å…¥å£
â”‚   â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”‚   â””â”€â”€ uploads/             # ä¸Šä¼ æ–‡ä»¶ä¸´æ—¶å­˜å‚¨
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ CLAUDE.md                  # é¡¹ç›®é…ç½®æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ ä»»åŠ¡æ¸…å•.md                # å¼€å‘ä»»åŠ¡è·Ÿè¸ª
â””â”€â”€ DEPLOYMENT.md              # éƒ¨ç½²æŒ‡å—
```

## ğŸš€ v1.2.0 æ–°åŠŸèƒ½ç‰¹æ€§

### âœ… æ–‡æ¡£ä¸Šä¼ åŠŸèƒ½

- **å¤šæ ¼å¼æ”¯æŒ**: PDFã€DOCXã€TXTã€MDã€SRT
- **æ‹–æ‹½ä¸Šä¼ **: ç°ä»£åŒ–çš„æ–‡ä»¶ä¸Šä¼ ä½“éªŒ
- **åŒæ¨¡å¼**: æ–‡ä»¶ä¸Šä¼  + ç›´æ¥æ–‡æœ¬è¾“å…¥
- **æ€§èƒ½ä¼˜åŒ–**: PyMuPDF é›†æˆï¼ŒPDF è§£æé€Ÿåº¦æå‡ 3-5 å€
- **ç•Œé¢ç®€åŒ–**: ç§»é™¤å¤æ‚é€‰é¡¹ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½

### âœ… AI å¤„ç†ä¼˜åŒ–

- **çŸ¥è¯†æ¶æ„å¸ˆæ¨¡æ¿**: ä¸“ä¸šçº§ä¿¡æ¯æå– prompt
- **æ— æŸä¿¡æ¯åŸåˆ™**: é›¶ä¿¡æ¯æŸå¤±ï¼Œå®Œæ•´ä¿ç•™å…³é”®ç»†èŠ‚
- **ç»“æ„ä¿ç•™**: è¯†åˆ«å¹¶ä¿æŒåŸæ–‡é€»è¾‘å±‚æ¬¡å…³ç³»
- **ç²¾ç¡®æç‚¼**: å…·ä½“åŒ–å‘ˆç°æ›¿ä»£æ¨¡ç³Šæ¦‚æ‹¬
- **å®Œæ•´æ€§æ£€æŸ¥**: æ¶µç›–æ‰€æœ‰ä¸»è¦è§‚ç‚¹å’Œæ”¯æ’‘è®ºæ®

### âœ… äº‘ç«¯éƒ¨ç½²

- **Render å¹³å°**: å‰åç«¯å®Œæ•´éƒ¨ç½²
- **ç”Ÿäº§ç¯å¢ƒ**: ç¨³å®šè¿è¡Œï¼Œå…¬ç½‘è®¿é—®
- **ç¯å¢ƒä¼˜åŒ–**: CORS é…ç½®ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–ç®¡ç†
- **åŒºåŸŸéƒ¨ç½²**: æ–°åŠ å¡èŠ‚ç‚¹ï¼Œä½å»¶è¿Ÿé«˜æ€§èƒ½

## ğŸ”§ API æ¥å£æ–‡æ¡£

### æ–‡æ¡£å¤„ç†æ¥å£

```http
POST /api/upload
Content-Type: multipart/form-data

å‚æ•°:
- file: ä¸Šä¼ çš„æ–‡ä»¶ (PDF/DOCX/TXT/MD/SRT)
- format_type: å›ºå®šä¸º "standard"

å“åº”:
{
  "success": true,
  "data": "# æ€ç»´å¯¼å›¾æ ‡é¢˜\n## ä¸»è¦å†…å®¹..."
}
```

```http
POST /api/process-text
Content-Type: application/json

å‚æ•°:
{
  "text": "è¦å¤„ç†çš„æ–‡æœ¬å†…å®¹",
  "format_type": "standard"
}

å“åº”:
{
  "success": true,
  "data": "# æ€ç»´å¯¼å›¾æ ‡é¢˜\n## ä¸»è¦å†…å®¹..."
}
```

### å¥åº·æ£€æŸ¥æ¥å£

```http
GET /health

å“åº”:
{
  "status": "healthy",
  "version": "1.2.0"
}
```

### API æ–‡æ¡£

å®Œæ•´çš„ API æ–‡æ¡£å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- åœ¨çº¿ç‰ˆæœ¬: https://thinktree-backend.onrender.com/docs
- æœ¬åœ°ç‰ˆæœ¬: http://localhost:8000/docs

## ğŸŒ å¼€å‘ç¯å¢ƒé…ç½®

### å‰ç«¯ç¯å¢ƒå˜é‡

```bash
# .env.local
NEXT_PUBLIC_API_URL=https://thinktree-backend.onrender.com  # ç”Ÿäº§ç¯å¢ƒ
# NEXT_PUBLIC_API_URL=http://localhost:8000                 # æœ¬åœ°å¼€å‘
```

### åç«¯ç¯å¢ƒå˜é‡

```bash
# .env
GEMINI_API_KEY=your_google_gemini_api_key
SECRET_KEY=your_secret_key_for_jwt
DEBUG=False  # ç”Ÿäº§ç¯å¢ƒ
```

### æœ¬åœ°å¼€å‘å¯åŠ¨

```bash
# å¯åŠ¨åç«¯ (ç«¯å£ 8000)
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
python main.py

# å¯åŠ¨å‰ç«¯ (ç«¯å£ 3000)
cd frontend
npm install
npm run dev
```

### äº‘ç«¯è®¿é—®

- **å‰ç«¯**: https://thinktree-frontend.onrender.com
- **åç«¯**: https://thinktree-backend.onrender.com

## ğŸ“Š é¡¹ç›®çŠ¶æ€

### å½“å‰ç‰ˆæœ¬: v1.2.0 âœ…

- **çŠ¶æ€**: ğŸŸ¢ äº‘ç«¯ç¨³å®šè¿è¡Œ
- **åŠŸèƒ½**: å®Œæ•´çš„æ–‡æ¡£åˆ°æ€ç»´å¯¼å›¾ç”Ÿæˆæµç¨‹
- **éƒ¨ç½²**: Render å¹³å°ï¼Œå‰åç«¯åˆ†ç¦»éƒ¨ç½²
- **æ€§èƒ½**: é«˜è´¨é‡ AI å¤„ç†ï¼Œæµç•…çš„ç”¨æˆ·ä½“éªŒ

### æ ¸å¿ƒæ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ æ–‡ä»¶ä¸Šä¼ /æ–‡æœ¬è¾“å…¥ â†’ FastAPIåç«¯æ¥æ”¶ â†’
æ–‡ä»¶è§£æå™¨æå–æ–‡æœ¬ â†’ Google Gemini AIå¤„ç† â†’
ç”ŸæˆMarkdownæ ¼å¼æ•°æ® â†’ è¿”å›å‰ç«¯ â†’
markmap-libè½¬æ¢ â†’ markmap-viewæ¸²æŸ“æ€ç»´å¯¼å›¾
```

### å…³é”®ç»„ä»¶è¯´æ˜

1. **FileUpload.jsx**:

   - æ”¯æŒæ‹–æ‹½ä¸Šä¼ å’Œæ–‡æœ¬è¾“å…¥åŒæ¨¡å¼
   - æ–‡ä»¶æ ¼å¼éªŒè¯å’Œå¤§å°é™åˆ¶
   - å®æ—¶ä¸Šä¼ çŠ¶æ€åé¦ˆ

2. **SimpleMarkmap.jsx**:

   - Markmap æ€ç»´å¯¼å›¾æ¸²æŸ“æ ¸å¿ƒç»„ä»¶
   - è‡ªé€‚åº”çª—å£å¤§å°
   - æ”¯æŒç¼©æ”¾ã€æ‹–æ‹½ã€å¹³ç§»äº¤äº’

3. **ai_processor.py**:

   - Google Gemini AI å¤„ç†å™¨
   - çŸ¥è¯†æ¶æ„å¸ˆ prompt æ¨¡æ¿
   - æ— æŸä¿¡æ¯æå–ç®—æ³•

4. **upload.py**:
   - æ–‡ä»¶ä¸Šä¼ å’Œæ–‡æœ¬å¤„ç† API
   - å¤šæ ¼å¼æ–‡æ¡£è§£æé›†æˆ
   - ç»Ÿä¸€çš„å“åº”æ ¼å¼

## ğŸ”® v2.0.0 è§„åˆ’

### ç”¨æˆ·ç³»ç»Ÿ

- ç”¨æˆ·æ³¨å†Œ/ç™»å½•åŠŸèƒ½
- æ€ç»´å¯¼å›¾ä¿å­˜å’Œå†å²è®°å½•
- ä¸ªäººæ§åˆ¶å°å’Œåå¥½è®¾ç½®

### åŠŸèƒ½å¢å¼º

- æ€ç»´å¯¼å›¾æ ·å¼å’Œä¸»é¢˜å®šåˆ¶
- èŠ‚ç‚¹ç¼–è¾‘å’Œæ‰‹åŠ¨è°ƒæ•´åŠŸèƒ½
- å¤šæ ¼å¼å¯¼å‡º (PNG/PDF/SVG)

### åä½œåŠŸèƒ½

- åˆ†äº«é“¾æ¥å’Œæƒé™æ§åˆ¶
- å®æ—¶åä½œç¼–è¾‘
- è¯„è®ºå’Œç‰ˆæœ¬å†å²

---

**æ›´æ–°æ—¥æœŸ**: 2024-07-22  
**é¡¹ç›®çŠ¶æ€**: ğŸŸ¢ v1.2.0 äº‘ç«¯ç¨³å®šè¿è¡Œ  
**æŠ€æœ¯æ¶æ„**: AI â†’ Markdown â†’ markmap-lib â†’ markmap-view  
**éƒ¨ç½²çŠ¶æ€**: Render äº‘å¹³å°å®Œæ•´éƒ¨ç½²
